<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Code de la Route â€” 10 questions</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <div class="container">
    <img src="logo_ispm.png" class="quiz-logo">
    <header>
      <h1>ðŸ“˜ Quiz 5 : Panneaux Mixtes ðŸ”€</h1>
      <div class="meta">Question <strong id="qnum">1</strong>/10</div>
    </header>

    <section class="card" id="quiz">
      <div class="question-area">
        <div class="q-left">
          <h2 id="question-text">Question text</h2>
          <p id="explain" style="color:var(--muted);margin-top:6px"></p>
          <div class="choices" id="choices"></div>
          <div class="controls" style="margin-top:12px">
            <button id="nextBtn">Valider / Suivant</button>
            <button id="skipBtn" class="ghost">Passer</button>
            <button id="resetBtn" class="ghost">RÃ©initialiser</button>
            <button class="autre" onclick="window.location.href='../accueil.html'">Autre Quiz</button>
          </div>
          <!-- RÃ©sultats dÃ©placÃ©s ici -->
          <div class="results" id="resultsBox">
            <div class="summary">
              <div>Score: <strong id="score">0</strong></div>
              <div id="final-msg" style="color:var(--muted)"></div>
            </div>
            <div id="review" style="margin-top:10px;color:var(--muted);font-size:14px"></div>
          </div>
        </div>
        

        <aside class="q-right">
          <div class="img-wrap">
            <img id="question-image" src="" alt="" />
          </div>
        
          <div style="width:100%">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <small style="color:var(--muted)">Temps par question:</small>
              <strong id="timer">â€”</strong>
            </div>
            <div class="progress" aria-hidden="true" style="margin-top:8px"><i id="progressBar"></i></div>

            <div class="results" id="resultsBox">
              <div class="summary"><div>Score: <strong id="score">0</strong></div><div id="final-msg" style="color:var(--muted)"></div></div>
              <div id="review" style="margin-top:10px;color:var(--muted);font-size:14px"></div>
            </div>
          </div>
        </aside>
      </div>
    </section>
  </div>
  <script>
    // Questions array: text, choices, correct index (0-based), explanation, image
  const questions = [
    {
      q: "Que signifie ce panneau Rond rouge avec piÃ©ton ?",
      img: "mixte/1.png",
      choices: ["Passage piÃ©ton","Interdiction aux piÃ©tons","Voie obligatoire pour piÃ©tons","Zone rÃ©sidentielle"],
      a: 1,
      exp: "ðŸ‘‰ Explication : DÃ©fense pour les piÃ©tons dâ€™entrer dans cette zone."
    },
    {
      q: "Que signifie ce panneau Triangle avec enfant ?",
      img: "mixte/2.png",
      choices: ["Interdiction aux enfants","Attention Ã©cole","Passage piÃ©ton","Aire de jeux"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Danger liÃ© Ã  la prÃ©sence dâ€™enfants, ralentir impÃ©rativement."
    },
    {
      q: "Que signifie ce panneau CarrÃ© bleu avec P ?",
      img: "mixte/3.png",
      choices: ["Interdiction de stationner","Parking","Parking vÃ©lo","Station essence "],
      a: 1,
      exp: "ðŸ‘‰ Explication : Stationnement autorisÃ© et prÃ©vu."
    },
    {
      q: "Que signifie un panneau Rond bleu avec flÃ¨che ?",
      img: "mixte/4.png",
      choices: ["Interdiction de tourner Ã  gauche","Route prioritaire","Obligation de tourner Ã  droite","Fin dâ€™interdiction"],
      a: 2,
      exp: "ðŸ‘‰ Explication : Direction obligatoire imposÃ©e."
    },
    {
      q: "Que signifie ce panneau Triangle avec pierres qui tombent ?",
      img: "mixte/5.png",
      choices: ["Route glissante","Route prioritaire","Chute de pierres","Aire de jeux"],
      a: 2,
      exp: "ðŸ‘‰ Explication : Danger frÃ©quent sur routes de montagne."
    },
    {
      q: "Que signifie ce panneau Rond rouge avec 70 ?",
      img: "mixte/6.png",
      choices: ["Vitesse minimale","Limitation de vitesse Ã  70 km/h","Fin de limitation","Vitesse minimale Ã  70 km/h"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Interdiction de dÃ©passer cette vitesse."
    },
    {
      q: "Que signifie le panneau CarrÃ© bleu avec fourchette ?",
      img: "mixte/7.png",
      choices: ["Restaurant","Aire de pique-nique","Station essence","Camping"],
      a: 0,
      exp: "ðŸ‘‰ Explication : Endroit prÃ©vu pour se restaurer."
    },
    {
      q: "Que signifie le panneau Rond rouge barrÃ© avec voiture ?",
      img: "mixte/8.jpg",
      choices: ["Interdiction aux vÃ©los","Interdiction aux vÃ©hicules motorisÃ©s","Interdiction aux piÃ©tons","Aire de repos"],
      a: 1,
      exp: "ðŸ‘‰ Explication : DÃ©fense dâ€™entrer pour voitures et motos."
    },
    {
      q: "Que signifie le panneau Triangle avec train ?",
      img: "mixte/9.png",
      choices: ["Gare","Passage Ã  niveau sans barriÃ¨re","Interdiction aux trains","Zone industrielle"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Danger : risque de train sans protection."
    },
    {
      q: "Que signifie un panneau Rond bleu avec vÃ©lo ?",
      img: "mixte/10.png",
      choices: ["Interdiction aux vÃ©los","Piste cyclable obligatoire","Parking vÃ©lo","DÃ©viation obligatoire"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Les vÃ©los doivent utiliser cette piste."
    }
  ];

  let current = 0;
  let score = 0;
  let selected = null;
  const qnum = document.getElementById('qnum');
  const questionText = document.getElementById('question-text');
  const choicesBox = document.getElementById('choices');
  const imgEl = document.getElementById('question-image');
  const explain = document.getElementById('explain');
  const nextBtn = document.getElementById('nextBtn');
  const skipBtn = document.getElementById('skipBtn');
  const resetBtn = document.getElementById('resetBtn');
  const scoreEl = document.getElementById('score');
  const resultsBox = document.getElementById('resultsBox');
  const review = document.getElementById('review');
  const progressBar = document.getElementById('progressBar');
  const timerEl = document.getElementById('timer');

  // Per-question timer (optional)
  const QUESTION_TIME = 15; // seconds
  let timeLeft = QUESTION_TIME;
  let timerInterval = null;

  function startTimer(){
    clearInterval(timerInterval);
    timeLeft = QUESTION_TIME;
    timerEl.textContent = `${timeLeft}s`;
    timerInterval = setInterval(()=>{
      timeLeft--;
      timerEl.textContent = `${timeLeft}s`;
      const pct = ((QUESTION_TIME - timeLeft)/QUESTION_TIME)*100;
      progressBar.style.width = pct + '%';
      if(timeLeft<=0){
        clearInterval(timerInterval);
        // auto-validate as skipped
        lockChoices();
        showCorrect();
        nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
      }
    },1000);
  }

  function renderQuestion(){
    selected = null;
    const q = questions[current];
    qnum.textContent = current+1;
    questionText.textContent = q.q;
    imgEl.src = q.img;
    explain.textContent = '';
    choicesBox.innerHTML = '';
    q.choices.forEach((c,i)=>{
      const div = document.createElement('div');
      div.className='choice';
      div.tabIndex = 0;
      div.innerHTML = `<strong>${String.fromCharCode(65+i)}.</strong> ${c}`;
      div.addEventListener('click', ()=> selectChoice(i,div));
      div.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') selectChoice(i,div); });
      choicesBox.appendChild(div);
    });
    nextBtn.textContent = 'Valider / Suivant';
    progressBar.style.width = '0%';
    startTimer();
  }

  function selectChoice(i,el){
    if(choicesBox.querySelector('.choice.correct') || choicesBox.querySelector('.choice.wrong')) return; // locked
    selected = i;
    // highlight selection
    [...choicesBox.children].forEach(ch=>ch.style.opacity=1);
    el.style.outline='2px solid rgba(255,255,255,0.06)';
  }

  function lockChoices(){
    clearInterval(timerInterval);
    [...choicesBox.children].forEach(ch=>ch.style.pointerEvents='none');
  }

  function showCorrect(){
    lockChoices();
    const q = questions[current];
    [...choicesBox.children].forEach((ch,idx)=>{
      if(idx===q.a) ch.classList.add('correct');
      if(selected!==null && idx===selected && selected!==q.a) ch.classList.add('wrong');
    });
    explain.textContent = q.exp;
  }

  nextBtn.addEventListener('click', ()=>{
    const q = questions[current];
    // if already locked, go to next
    if(choicesBox.querySelector('.choice.correct')){
      current++;
      if(current >= questions.length) return showResults();
      renderQuestion();
      return;
    }
    // validate
    if(selected === null){
      // treat as wrong / no answer
      showCorrect();
      nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
      return;
    }
    if(selected === q.a){ score++; scoreEl.textContent = score; }
    showCorrect();
    nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
  });

  skipBtn.addEventListener('click', ()=>{
    showCorrect();
    nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
  });

  resetBtn.addEventListener('click', ()=>{
    if(!confirm('RÃ©initialiser le quiz ?')) return;
    current=0;score=0;scoreEl.textContent=0;resultsBox.style.display='none';renderQuestion();
  });

  function showResults(){
    clearInterval(timerInterval);
    resultsBox.style.display='block';
    const percent = Math.round((score/questions.length)*100);
    const finalMsg = document.getElementById('final-msg');
    finalMsg.textContent = `${percent}% â€” ${score}/${questions.length}`;
    // review
    review.innerHTML = '';
    questions.forEach((q,i)=>{
      const div = document.createElement('div');
      div.style.padding='6px 0';
      div.innerHTML = `<strong>Q${i+1}:</strong> ${q.q} â€” RÃ©ponse: <em>${q.choices[q.a]}</em><div style='color:var(--muted);font-size:13px'>${q.exp}</div>`;
      review.appendChild(div);
    });
    // optionally offer to restart
  }

  // init
  renderQuestion();
  </script>
  
</body>
</html>