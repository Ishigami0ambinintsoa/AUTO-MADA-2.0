<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Code de la Route â€” 10 questions</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <img src="indication/logo_ispm.png" class="quiz-logo">
  <div class="container">
    <header>
      <h1>ðŸ“˜ Quiz 4 : Panneaux dâ€™Indication</h1>
      <div class="meta">Question <strong id="qnum">1</strong>/10</div>
    </header>

    <section class="card" id="quiz">
      <div class="question-area">
        <div class="q-left">
          <h2 id="question-text">Question text</h2>
          <p id="explain" style="color:var(--muted);margin-top:6px"></p>
          <div class="choices" id="choices"></div>
          <div class="controls" style="margin-top:12px">
            <button id="nextBtn">Valider / Suivant</button>
            <button id="skipBtn" class="ghost">Passer</button>
            <button id="resetBtn" class="ghost">RÃ©initialiser</button>
            <button class="autre" onclick="window.location.href='../accueil.html'">Autre Quiz</button>
          </div>
        </div>

        <aside class="q-right">
          <div class="img-wrap">
            <img id="question-image" src="" alt="" />
          </div>
        
          <div style="width:100%">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <small style="color:var(--muted)">Temps par question:</small>
              <strong id="timer">â€”</strong>
            </div>
            <div class="progress" aria-hidden="true" style="margin-top:8px"><i id="progressBar"></i></div>

            <div class="results" id="resultsBox">
              <div class="summary"><div>Score: <strong id="score">0</strong></div><div id="final-msg" style="color:var(--muted)"></div></div>
              <div id="review" style="margin-top:10px;color:var(--muted);font-size:14px"></div>
            </div>
          </div>
        </aside>
      </div>
    </section>
  </div>
  <script>
    // Questions array: text, choices, correct index (0-based), explanation, image
  const questions = [
    {
      q: "Que signifie ce panneau CarrÃ© bleu avec P ?",
      img: "indication/1.png",
      choices: ["Interdiction de stationner","Parking","Aire de jeux","Route barrÃ©e"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Indique un emplacement rÃ©servÃ© au stationnement."
    },
    {
      q: "Que signifie ce panneau CarrÃ© bleu avec croix rouge ?",
      img: "indication/2.png",
      choices: ["Caserne de pompiers","HÃ´pital","Pharmacie","Police"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Signale la prÃ©sence dâ€™un service de soins."
    },
    {
      q: "Que signifie ce panneau CarrÃ© bleu avec fourchette et couteau ?",
      img: "indication/3.png",
      choices: ["Aire de pique-nique","Restaurant","HÃ´tel","Bar"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Indique un lieu oÃ¹ lâ€™on peut se restaurer."
    },
    {
      q: "Que signifie un panneau CarrÃ© bleu avec lit ?",
      img: "indication/4.png",
      choices: ["Aire de repos","Station-service","HÃ´tel"," Parking"],
      a: 2,
      exp: "ðŸ‘‰ Explication : Signale un Ã©tablissement dâ€™hÃ©bergement."
    },
    {
      q: "Que signifie ce panneau CarrÃ© bleu avec station essence ?",
      img: "indication/5.jpg",
      choices: ["Parking","Station de lavage","Station-service","Zone rÃ©sidentielle"],
      a: 2,
      exp: "ðŸ‘‰ Explication : Indique la disponibilitÃ© de carburant."
    },
    {
      q: "Que signifie ce panneau CarrÃ© bleu avec bus ?",
      img: "indication/6.png",
      choices: ["Interdiction aux bus"," ArrÃªt dâ€™autobus","Gare routiÃ¨re","Parking bus"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Lieu prÃ©vu pour la montÃ©e et descente des passagers."
    },
    {
      q: "Que signifie le panneau CarrÃ© bleu avec i ?",
      img: "indication/7.png",
      choices: ["Point dâ€™information","Interdiction dâ€™entrÃ©e","Bureau de police","Poste de douane"],
      a: 0,
      exp: "ðŸ‘‰ Explication : Endroit oÃ¹ obtenir des renseignements."
    },
    {
      q: "Que signifie le panneau CarrÃ© bleu avec WC ?",
      img: "indication/8.png",
      choices: ["Camping","Toilettes publiques","Station-service","Toilettes privÃ©es"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Signale des sanitaires accessibles au public."
    },
    {
      q: "Que signifie le panneau CarrÃ© bleu avec tÃ©lÃ©phone ?",
      img: "indication/9.png",
      choices: ["Poste de police","TÃ©lÃ©phone public","Bureau de poste","ArrÃªt de bus"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Indique la disponibilitÃ© dâ€™un tÃ©lÃ©phone en libre accÃ¨s."
    },
    {
      q: "Que signifie un panneau CarrÃ© bleu avec aire de repos ?",
      img: "indication/10.jpg",
      choices: ["Interdiction de stationner","Aire de repos","Aire de jeux","Station-service"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Endroit amÃ©nagÃ© pour sâ€™arrÃªter, se reposer ou pique-niquer."
    }
  ];

  let current = 0;
  let score = 0;
  let selected = null;
  const qnum = document.getElementById('qnum');
  const questionText = document.getElementById('question-text');
  const choicesBox = document.getElementById('choices');
  const imgEl = document.getElementById('question-image');
  const explain = document.getElementById('explain');
  const nextBtn = document.getElementById('nextBtn');
  const skipBtn = document.getElementById('skipBtn');
  const resetBtn = document.getElementById('resetBtn');
  const scoreEl = document.getElementById('score');
  const resultsBox = document.getElementById('resultsBox');
  const review = document.getElementById('review');
  const progressBar = document.getElementById('progressBar');
  const timerEl = document.getElementById('timer');

  // Per-question timer (optional)
  const QUESTION_TIME = 15; // seconds
  let timeLeft = QUESTION_TIME;
  let timerInterval = null;

  function startTimer(){
    clearInterval(timerInterval);
    timeLeft = QUESTION_TIME;
    timerEl.textContent = `${timeLeft}s`;
    timerInterval = setInterval(()=>{
      timeLeft--;
      timerEl.textContent = `${timeLeft}s`;
      const pct = ((QUESTION_TIME - timeLeft)/QUESTION_TIME)*100;
      progressBar.style.width = pct + '%';
      if(timeLeft<=0){
        clearInterval(timerInterval);
        // auto-validate as skipped
        lockChoices();
        showCorrect();
        nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
      }
    },1000);
  }

  function renderQuestion(){
    selected = null;
    const q = questions[current];
    qnum.textContent = current+1;
    questionText.textContent = q.q;
    imgEl.src = q.img;
    explain.textContent = '';
    choicesBox.innerHTML = '';
    q.choices.forEach((c,i)=>{
      const div = document.createElement('div');
      div.className='choice';
      div.tabIndex = 0;
      div.innerHTML = `<strong>${String.fromCharCode(65+i)}.</strong> ${c}`;
      div.addEventListener('click', ()=> selectChoice(i,div));
      div.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') selectChoice(i,div); });
      choicesBox.appendChild(div);
    });
    nextBtn.textContent = 'Valider / Suivant';
    progressBar.style.width = '0%';
    startTimer();
  }

  function selectChoice(i,el){
    if(choicesBox.querySelector('.choice.correct') || choicesBox.querySelector('.choice.wrong')) return; // locked
    selected = i;
    // highlight selection
    [...choicesBox.children].forEach(ch=>ch.style.opacity=1);
    el.style.outline='2px solid rgba(255,255,255,0.06)';
  }

  function lockChoices(){
    clearInterval(timerInterval);
    [...choicesBox.children].forEach(ch=>ch.style.pointerEvents='none');
  }

  function showCorrect(){
    lockChoices();
    const q = questions[current];
    [...choicesBox.children].forEach((ch,idx)=>{
      if(idx===q.a) ch.classList.add('correct');
      if(selected!==null && idx===selected && selected!==q.a) ch.classList.add('wrong');
    });
    explain.textContent = q.exp;
  }

  nextBtn.addEventListener('click', ()=>{
    const q = questions[current];
    // if already locked, go to next
    if(choicesBox.querySelector('.choice.correct')){
      current++;
      if(current >= questions.length) return showResults();
      renderQuestion();
      return;
    }
    // validate
    if(selected === null){
      // treat as wrong / no answer
      showCorrect();
      nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
      return;
    }
    if(selected === q.a){ score++; scoreEl.textContent = score; }
    showCorrect();
    nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
  });

  skipBtn.addEventListener('click', ()=>{
    showCorrect();
    nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
  });

  resetBtn.addEventListener('click', ()=>{
    if(!confirm('RÃ©initialiser le quiz ?')) return;
    current=0;score=0;scoreEl.textContent=0;resultsBox.style.display='none';renderQuestion();
  });

  function showResults(){
    clearInterval(timerInterval);
    resultsBox.style.display='block';
    const percent = Math.round((score/questions.length)*100);
    const finalMsg = document.getElementById('final-msg');
    finalMsg.textContent = `${percent}% â€” ${score}/${questions.length}`;
    // review
    review.innerHTML = '';
    questions.forEach((q,i)=>{
      const div = document.createElement('div');
      div.style.padding='6px 0';
      div.innerHTML = `<strong>Q${i+1}:</strong> ${q.q} â€” RÃ©ponse: <em>${q.choices[q.a]}</em><div style='color:var(--muted);font-size:13px'>${q.exp}</div>`;
      review.appendChild(div);
    });
    // optionally offer to restart
  }

  // init
  renderQuestion();
  </script>
  
</body>
</html>