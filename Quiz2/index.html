<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Code de la Route â€” 10 questions</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <img src="interdiction/logo_ispm.png" class="quiz-logo">
  <div class="container">
    <header>
      <h1>ðŸ“˜ Quiz 2 : Panneaux dâ€™Interdiction ðŸš«</h1>
      <div class="meta">Question <strong id="qnum">1</strong>/10</div>
    </header>

    <section class="card" id="quiz">
      <div class="question-area">
        <div class="q-left">
          <h2 id="question-text">Question text</h2>
          <p id="explain" style="color:var(--muted);margin-top:6px"></p>
          <div class="choices" id="choices"></div>
          <div class="controls" style="margin-top:12px">
            <button id="nextBtn">Valider / Suivant</button>
            <button id="skipBtn" class="ghost">Passer</button>
            <button id="resetBtn" class="ghost">RÃ©initialiser</button>
            <button class="autre" onclick="window.location.href='../accueil.html'">Autre Quiz</button>
          </div>
        </div>

        <aside class="q-right">
          <div class="img-wrap">
            <img id="question-image" src="" alt="" />
          </div>
        
          <div style="width:100%">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <small style="color:var(--muted)">Temps par question:</small>
              <strong id="timer">â€”</strong>
            </div>
            <div class="progress" aria-hidden="true" style="margin-top:8px"><i id="progressBar"></i></div>

            <div class="results" id="resultsBox">
              <div class="summary"><div>Score: <strong id="score">0</strong></div><div id="final-msg" style="color:var(--muted)"></div></div>
              <div id="review" style="margin-top:10px;color:var(--muted);font-size:14px"></div>
            </div>
          </div>
        </aside>
      </div>
    </section>
  </div>
  <script>
    // Questions array: text, choices, correct index (0-based), explanation, image
  const questions = [
    {
      q: "Que signifie ce panneau Rond rouge barrÃ© avec voiture ?",
      img: "interdiction/1.png",
      choices: ["Route rÃ©servÃ©e aux vÃ©los","Interdiction aux vÃ©hicules motorisÃ©s","Parking","Route prioritaire"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Aucun vÃ©hicule Ã  moteur ne peut circuler au-delÃ  de ce panneau."
    },
    {
      q: "Que signifie ce panneau Rond rouge avec un vÃ©lo",
      img: "interdiction/2.png",
      choices: ["Piste cyclable obligatoire","Interdiction aux cycles","Passage pour piÃ©tons","Route barrÃ©e"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Les vÃ©los ne sont pas autorisÃ©s Ã  circuler sur cette route."
    },
    {
      q: "Que signifie ce panneau Rond rouge avec 50 ?",
      img: "interdiction/3.jpg",
      choices: ["Vitesse minimale","Limitation de vitesse Ã  50 km/h ","Fin de limitation","Interdiction de stationner"],
      a: 1,
      exp: "ðŸ‘‰ Explication : DÃ©fense de dÃ©passer la vitesse maximale indiquÃ©e."
    },
    {
      q: "Que signifie un panneau Rond rouge barrÃ© avec un camion ?",
      img: "interdiction/4.png",
      choices: ["DÃ©viation","Parking camion","Interdiction aux poids lourds","Route en travaux"],
      a: 2,
      exp: "ðŸ‘‰ Explication : Les vÃ©hicules de transport de marchandises au-delÃ  dâ€™un certain tonnage ne peuvent pas passer."
    },
    {
      q: "Que signifie ce panneau Rond rouge avec klaxon barrÃ© ?",
      img: "interdiction/5.png",
      choices: ["Fin dâ€™interdiction de dÃ©passer","Interdit aux enfants","Interdiction de klaxonner","Interdiction aux vÃ©los"],
      a: 2,
      exp: "ðŸ‘‰ Explication : DÃ©fense de klaxonner, sauf urgence, souvent prÃ¨s des hÃ´pitaux."
    },
    {
      q: "Que signifie ce panneau Rond rouge avec un piÃ©ton ?",
      img: "interdiction/6.png",
      choices: ["Zone de rencontre","Interdiction aux piÃ©tons","Zone piÃ©tonne","Aire de repos"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Les piÃ©tons ne doivent pas marcher dans cette zone (tunnel, autoroute)."
    },
    {
      q: "Que signifie le panneau Rond rouge avec flÃ¨che droite barrÃ©e ?",
      img: "interdiction/7.png",
      choices: ["Interdiction de tourner Ã  droite","Obligation de tourner Ã  gauche","DÃ©viation obligatoire","Fin de prioritÃ©"],
      a: 0,
      exp: "ðŸ‘‰ Explication : DÃ©fense de prendre la direction indiquÃ©e."
    },
    {
      q: "Que signifie le panneau Rond rouge avec flÃ¨che demi-tour barrÃ©e ?",
      img: "interdiction/8.png",
      choices: ["Sens interdit","Interdiction de faire demi-tour","Route barrÃ©e","Interdiction tourner"],
      a: 1,
      exp: "ðŸ‘‰ Explication : Interdit de rebrousser chemin Ã  cet endroit."
    },
    {
      q: "Que signifie le panneau Rond rouge avec deux voitures ?",
      img: "interdiction/9.png",
      choices: ["Stationnement interdit","Interdiction de dÃ©passer ","Parking rÃ©servÃ©","Intersection dangereuse"],
      a: 1,
      exp: "ðŸ‘‰ Explication : DÃ©fense de dÃ©passer sauf deux-roues sans side-car."
    },
    {
      q: "Que signifie un panneau Rond rouge avec entrÃ©e barrÃ©e ?",
      img: "interdiction/10.jpg",
      choices: ["Intersection avec prioritÃ©","Sens interdit","Fin de limitation","Interdiction de circuler"],
      a: 1,
      exp: "ðŸ‘‰ Explication : DÃ©fense absolue de pÃ©nÃ©trer dans la voie en sens inverse."
    }
  ];

  let current = 0;
  let score = 0;
  let selected = null;
  const qnum = document.getElementById('qnum');
  const questionText = document.getElementById('question-text');
  const choicesBox = document.getElementById('choices');
  const imgEl = document.getElementById('question-image');
  const explain = document.getElementById('explain');
  const nextBtn = document.getElementById('nextBtn');
  const skipBtn = document.getElementById('skipBtn');
  const resetBtn = document.getElementById('resetBtn');
  const scoreEl = document.getElementById('score');
  const resultsBox = document.getElementById('resultsBox');
  const review = document.getElementById('review');
  const progressBar = document.getElementById('progressBar');
  const timerEl = document.getElementById('timer');

  // Per-question timer (optional)
  const QUESTION_TIME = 15; // seconds
  let timeLeft = QUESTION_TIME;
  let timerInterval = null;

  function startTimer(){
    clearInterval(timerInterval);
    timeLeft = QUESTION_TIME;
    timerEl.textContent = `${timeLeft}s`;
    timerInterval = setInterval(()=>{
      timeLeft--;
      timerEl.textContent = `${timeLeft}s`;
      const pct = ((QUESTION_TIME - timeLeft)/QUESTION_TIME)*100;
      progressBar.style.width = pct + '%';
      if(timeLeft<=0){
        clearInterval(timerInterval);
        // auto-validate as skipped
        lockChoices();
        showCorrect();
        nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
      }
    },1000);
  }

  function renderQuestion(){
    selected = null;
    const q = questions[current];
    qnum.textContent = current+1;
    questionText.textContent = q.q;
    imgEl.src = q.img;
    explain.textContent = '';
    choicesBox.innerHTML = '';
    q.choices.forEach((c,i)=>{
      const div = document.createElement('div');
      div.className='choice';
      div.tabIndex = 0;
      div.innerHTML = `<strong>${String.fromCharCode(65+i)}.</strong> ${c}`;
      div.addEventListener('click', ()=> selectChoice(i,div));
      div.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') selectChoice(i,div); });
      choicesBox.appendChild(div);
    });
    nextBtn.textContent = 'Valider / Suivant';
    progressBar.style.width = '0%';
    startTimer();
  }

  function selectChoice(i,el){
    if(choicesBox.querySelector('.choice.correct') || choicesBox.querySelector('.choice.wrong')) return; // locked
    selected = i;
    // highlight selection
    [...choicesBox.children].forEach(ch=>ch.style.opacity=1);
    el.style.outline='2px solid rgba(255,255,255,0.06)';
  }

  function lockChoices(){
    clearInterval(timerInterval);
    [...choicesBox.children].forEach(ch=>ch.style.pointerEvents='none');
  }

  function showCorrect(){
    lockChoices();
    const q = questions[current];
    [...choicesBox.children].forEach((ch,idx)=>{
      if(idx===q.a) ch.classList.add('correct');
      if(selected!==null && idx===selected && selected!==q.a) ch.classList.add('wrong');
    });
    explain.textContent = q.exp;
  }

  nextBtn.addEventListener('click', ()=>{
    const q = questions[current];
    // if already locked, go to next
    if(choicesBox.querySelector('.choice.correct')){
      current++;
      if(current >= questions.length) return showResults();
      renderQuestion();
      return;
    }
    // validate
    if(selected === null){
      // treat as wrong / no answer
      showCorrect();
      nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
      return;
    }
    if(selected === q.a){ score++; scoreEl.textContent = score; }
    showCorrect();
    nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
  });

  skipBtn.addEventListener('click', ()=>{
    showCorrect();
    nextBtn.textContent = (current < questions.length-1) ? 'Suivant' : 'Voir rÃ©sultat';
  });

  resetBtn.addEventListener('click', ()=>{
    if(!confirm('RÃ©initialiser le quiz ?')) return;
    current=0;score=0;scoreEl.textContent=0;resultsBox.style.display='none';renderQuestion();
  });

  function showResults(){
    clearInterval(timerInterval);
    resultsBox.style.display='block';
    const percent = Math.round((score/questions.length)*100);
    const finalMsg = document.getElementById('final-msg');
    finalMsg.textContent = `${percent}% â€” ${score}/${questions.length}`;
    // review
    review.innerHTML = '';
    questions.forEach((q,i)=>{
      const div = document.createElement('div');
      div.style.padding='6px 0';
      div.innerHTML = `<strong>Q${i+1}:</strong> ${q.q} â€” RÃ©ponse: <em>${q.choices[q.a]}</em><div style='color:var(--muted);font-size:13px'>${q.exp}</div>`;
      review.appendChild(div);
    });
    // optionally offer to restart
  }

  // init
  renderQuestion();
  </script>
  
</body>
</html>
